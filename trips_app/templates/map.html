{% extends 'base.html' %}


{% block title %}
    <title>Trip List Manager  TrackMyAsset</title>
{% endblock title %}

{% block content %}
    <div class='container'>
       <!DOCTYPE html>
    <html>
      <head>

          <title>Interactive maps for Django web apps</title>
        <title>Interactive maps for Django web apps</title><script src='https://api.mapbox.com/mapbox-gl-js/v1.8.1/mapbox-gl.js'></script>
        <link href='https://api.mapbox.com/mapbox-gl-js/v1.8.1/mapbox-gl.css' rel='stylesheet' />
        <style>
            .marker {
                background-image: url('mapbox-icon.png');
                background-size: cover;
                width: 50px;
                height: 50px;
                border-radius: 50%;
                cursor: pointer;
            }
        </style>
      </head>
        <br/>
    <body>
    {% csrf_token %}
    <p>what is here {{ latitude }}</p>
        {% for k,v in dataset.items %}
            <tr>
            <td>
            {{k}}:{{v}}</td>
            <tr>
        {% endfor %}

        <p>Click the button to get your coordinates.</p>

        <button onclick="getLocation()">Try It</button>

        <p id="demo"></p>

         <script>
            var x = document.getElementById("demo");

            function getLocation() {
              if (navigator.geolocation) {
                navigator.geolocation.getCurrentPosition(showPosition);
              } else {
                x.innerHTML = "Geolocation is not supported by this browser.";
              }
            }

            function showPosition(position) {
              x.innerHTML = "Latitude: " + position.coords.latitude +
              "<br>Longitude: " + position.coords.longitude;
            }
            </script>
            <div id='map' style='width: 100%; height: 400px;'></div>
             <script>
                mapboxgl.accessToken = 'pk.eyJ1IjoiamltYWhlcm4xMSIsImEiOiJjazk0aDdxb3AwNTV2M2dvdXBoM3R1MXR4In0.TPDbIqO_Nj9PJjWZuYly-w';
                    var map = new mapboxgl.Map({
                    container: 'map',
                    style: 'mapbox://styles/mapbox/streets-v11',
                    center: [-8.690310, 52.667700],
                    zoom: 10.7
                    });
                    var geojson = {
                      type: 'FeatureCollection',
                      features: [{
                          type: 'Feature',
                          geometry: {
                              type: 'Point',
                              coordinates: [-8.6026825, 52.683880167]
                          },
                          properties: {
                              title: 'Mapbox',
                              description: 'Your current location'
                          }
                      }]
                    };

                   // add markers to map
                                geojson.features.forEach(function(marker) {

                                  // create a HTML element for each feature
                                  var el = document.createElement('div');
                                  el.className = 'marker';

                                  // make a marker for each feature and add to the map
                                  new mapboxgl.Marker(el)
                                    .setLngLat(marker.geometry.coordinates)
                                    .addTo(map);
                                });

                    map.addControl(new mapboxgl.NavigationControl());
                    map.on('click', function(e) {
                      var features = map.queryRenderedFeatures(e.point, {
                        layers: ['layer-name-here'] // replace this with the name of the layer
                      });

                      if (!features.length) {
                        return;
                      }

                      var feature = features[0];

                      var popup = new mapboxgl.Popup({ offset: [0, -15] })
                        .setLngLat(feature.geometry.coordinates)
                        .setHTML('<h3>' + feature.properties.title + '</h3><p>' + feature.properties.description + '</p>')
                        .addTo(map);
                    });
            </script>

      </body>
    </html>
         </div>

{% endblock content %}
